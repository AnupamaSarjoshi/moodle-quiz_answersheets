define(["jquery","core/ajax","core/notification"],function(a,b,c){var d={mconfig:null,SELECTOR:{PAGE_HEADER:".attempt-sheet-header-gecko",PAGE_CONTAINER:"#page",QTYPE_ORDERING_VERTICAL_SORTABLE_LIST:".que.ordering ul.sortablelist.vertical li",QTYPE_ORDERING_MARGIN:".orderingmargin"},TEMPLATE:{QTYPE_ORDERING_MARGIN:'<div class="orderingmargin"></div>'},pageHeaderHeight:0,pageContainer:null,pageHeader:null,init:function(b){d.mconfig=b,d.pageHeader=a(d.SELECTOR.PAGE_HEADER),d.pageContainer=a(d.SELECTOR.PAGE_CONTAINER),d.pageHeaderHeight=d.pageHeader.height(),d.pageHeader.css("top",-Math.abs(d.pageHeaderHeight)),d.pageContainer.css("margin-top",d.pageHeaderHeight),window.addEventListener("beforeprint",d.handlePrintStart),window.addEventListener("afterprint",d.handlePrintStop)},handlePrintStart:function(a){a.preventDefault(),d.pageContainer.css("margin-top",0),Y.UA.gecko&&(d.pageContainer.css("padding-top",d.pageHeaderHeight+30),d.pageHeader.css("top",0)),d.handlePrintForOrdering(!0);var e=b.call([{methodname:"quiz_answersheets_create_event",args:{attemptid:d.mconfig.attemptid,userid:d.mconfig.userid,courseid:d.mconfig.courseid,cmid:d.mconfig.cmid,quizid:d.mconfig.quizid,pagetype:d.mconfig.pagetype}}]);e[0].then(function(){return!0}).fail(function(a){c.exception(a)})},handlePrintStop:function(a){return a.preventDefault(),d.pageContainer.css("margin-top",d.pageHeaderHeight),Y.UA.gecko&&(d.pageContainer.css("padding-top",0),d.pageHeader.css("top",-Math.abs(d.pageHeaderHeight))),d.handlePrintForOrdering(!1),!0},handlePrintForOrdering:function(b){var c=a(d.SELECTOR.QTYPE_ORDERING_VERTICAL_SORTABLE_LIST);c.length&&c.each(function(c,e){b===!0?(a(e).before(d.TEMPLATE.QTYPE_ORDERING_MARGIN),a(e).after(d.TEMPLATE.QTYPE_ORDERING_MARGIN)):a(d.SELECTOR.QTYPE_ORDERING_MARGIN).remove()})}};return d});